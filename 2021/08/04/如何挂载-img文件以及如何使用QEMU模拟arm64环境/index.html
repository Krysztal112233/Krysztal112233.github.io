<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png"><link rel="icon" href="/img/fluid.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="Krysztal"><meta name="keywords" content=""><meta name="description" content="在上一篇中编译 OpenCV 成功之后我把整个树莓派的 TF 卡使用 dd 命令导出成了 .img 文件作为备份。我会暂时有一段时间无法接触到我的树莓派，并且我还有很多步骤没有完成。 所以我就想是否能挂载到 x86 Linux host 上进行操作？"><meta property="og:type" content="article"><meta property="og:title" content="如何挂载.img文件，以及如何使用QEMU模拟arm64环境"><meta property="og:url" content="https://blog.krysztal.dev/2021/08/04/%E5%A6%82%E4%BD%95%E6%8C%82%E8%BD%BD-img%E6%96%87%E4%BB%B6%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8QEMU%E6%A8%A1%E6%8B%9Farm64%E7%8E%AF%E5%A2%83/index.html"><meta property="og:site_name" content="Krysztal的书桌"><meta property="og:description" content="在上一篇中编译 OpenCV 成功之后我把整个树莓派的 TF 卡使用 dd 命令导出成了 .img 文件作为备份。我会暂时有一段时间无法接触到我的树莓派，并且我还有很多步骤没有完成。 所以我就想是否能挂载到 x86 Linux host 上进行操作？"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2021-08-04T01:12:08.000Z"><meta property="article:modified_time" content="2024-06-04T11:00:15.016Z"><meta property="article:author" content="Krysztal"><meta property="article:tag" content="技术"><meta property="article:tag" content="捣鼓"><meta name="twitter:card" content="summary_large_image"><meta name="referrer" content="no-referrer-when-downgrade"><title>如何挂载.img文件，以及如何使用QEMU模拟arm64环境 - Krysztal的书桌</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"blog.krysztal.dev",root:"/",version:"1.9.7",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,follow_dnt:!0,baidu:null,google:{measurement_id:null},tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml",include_content_in_search:!0};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="Krysztal的书桌" type="application/atom+xml">
</head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>亘古之白</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/" target="_self"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/" target="_self"><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/" target="_self"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/" target="_self"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/about/" target="_self"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item"><a class="nav-link" href="/links/" target="_self"><i class="iconfont icon-link-fill"></i> <span>友链</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/nes/default.webp) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="如何挂载.img文件，以及如何使用QEMU模拟arm64环境"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2021-08-04 01:12" pubdate>2021年8月4日 凌晨</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 1.6k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 14 分钟</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">如何挂载.img文件，以及如何使用QEMU模拟arm64环境</h1><div class="markdown-body"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>在上一篇中编译 OpenCV 成功之后我把整个树莓派的 TF 卡使用 dd 命令导出成了 .img 文件作为备份。我会暂时有一段时间无法接触到我的树莓派，并且我还有很多步骤没有完成。</p><p>所以我就想是否能挂载到 x86 Linux host 上进行操作？</p><span id="more"></span><h2 id="如何-dd-出系统镜像文件">如何 dd 出系统镜像文件？</h2><p>使用大部分 Linux 发行版都自带的 dd 命令即刻。</p><p>想象一下当初你是如何使用 dd 命令制作 Linux 的 LiveCD 的？</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">sudo <span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=&lt;the_path_to_ISO_file&gt; of=/dev/sdx<br></code></pre></td></tr></table></figure><p>其中 <code>/dev/sdx</code> 为<strong>设备文件</strong>，通常他们存在于 <code>/dev/</code> 目录之下.</p><p>那我们再想一想是不是可以反过来？</p><p>于是得出了以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">sudo <span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/sdx of=rpimg.img<br></code></pre></td></tr></table></figure><p>注意，这里必须为设备文件而不是设备分区文件，除非你想备份分区。</p><p>由于 TF 卡大小为 64GiB，换算为 GB 单位则为 60GB，是非常庞大的数据量，由于 Linux 系统调度的特性所以卡顿是很正常的现象。我的 TF 卡搭配 USB3.0 读卡器经过测试这个过程将会持续十分钟。</p><h2 id="奇怪的想法">奇怪的想法</h2><p>在思考是否可以在 x86 Linux host 上进行操作的时候我产生了一些疑问：</p><ul><li>此时的 img 文件为何种格式？</li><li>是否可以使用 chroot 以及 QEMU 操作 img 文件内内容？</li></ul><h2 id="验证奇怪的想法">验证奇怪的想法</h2><h3 id="qemu-是否可以模拟运行-arm64aarch64">QEMU 是否可以模拟运行 arm64（aarch64）？</h3><p>经过资料的查找我们可以发现树莓派所使用的 SoC 为博通 BCM2711，大架构属于 ARM v8。</p><p>因此需要查找 QEMU 现在是否可以模拟 ARM v8</p><p>在 debian 的软件包搜索当中我们发现 <code>qemu-user-static</code> <a href="https://packages.debian.org/bullseye/qemu-user">软件包</a>中有如下描述</p><blockquote><p>QEMU is a fast processor emulator: currently the package supports <strong>ARM</strong>, CRIS, i386, M68k (ColdFire), MicroBlaze, MIPS, PowerPC, SH4, SPARC and x86-64 emulation. By using dynamic translation it achieves reasonable speed while being easy to port on new host CPUs.</p><p>This package provides the user mode emulation binaries. In this mode QEMU can <strong>launch Linux processes compiled for one CPU on another CPU</strong>.</p></blockquote><p>感觉上大概是完全可以的。</p><p>选择 <code>user mode</code> 的 QEMU 而不是 <code>system mode</code> ，原因有二</p><ol type="1"><li>我们目标是挂载 img 并且使用 chroot 运行</li><li>这里使用 chroot jail 并不需要启动整个系统，相对而言其实是一套软件，因此是用户态。</li></ol><p><strong>另外这里并不是虚拟机。</strong> chroot 本质上只是变更当前进程及其子进程的可见根路径。变更后，程序无法访问可见根目录外文件和命令。<strong>chroot 的大欺骗战术！</strong></p><p>另外其实可以不使用 chroot，使用 Fakechroot 以及 PRoot 也是可以的</p><p>关于 PRoot 以及 Fakechroot 的用法可以参照以下链接</p><ul><li><a href="http://manpages.ubuntu.com/manpages/precise/man1/fakechroot.1.html">Fakechroot</a></li><li><a href="https://wiki.archlinux.org/title/PRoot">PRoot</a></li></ul><p>使用如下命令安装 <code>qemu-user-static</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">sudo apt install -y qemu-user-static<br></code></pre></td></tr></table></figure><p>他会自动配置 binary handle，如果执行的二进制文件架构是 qemu 支持的但是不是本机架构的话会自动使用 qemu 运行。</p><h3 id="img-文件分析">img 文件分析</h3><h4 id="逻辑">逻辑</h4><p>还记得上文中所提到的<code>设备文件</code>吗？在 Linux 当中把和设备交互的地方抽象成为了一个文件。</p><p>再联想一下 Linux 系统（乃至于各种 unix like 系统）当中的一个很大的特性：<strong>一切皆文件</strong>。</p><p>我们是从 TF 卡中完整的复制内容到 img 文件，那么是否在这个 img 文件当中包含了分区信息？</p><p>如果说我们知道了 img 文件当中的分区的起始点与结束点，那么他不就可以被抽象成为类似设备文件一样的东西了吗？</p><h4 id="验证由-dd-设备文件而来的-img-文件是否拥有完整的分区格式">验证由 dd 设备文件而来的 img 文件是否拥有完整的分区格式</h4><p>祭出我们常用的<code>fdisk</code>命令，其堪称操作设备文件的瑞士军刀。</p><p>对 img 文件使用以下命令。我的 img 文件名为 rpios.img。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">sudo fdisk -l rpimg.img<br></code></pre></td></tr></table></figure><p>他输出了以下内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs Bash">Disk rpimg.img: 59.69 GiB, 64088965120 bytes, 125173760 sectors<br>Units: sectors of 1 * 512 = 512 bytes<br>Sector size (logical/physical): 512 bytes / 512 bytes<br>I/O size (minimum/optimal): 512 bytes / 512 bytes<br>Disklabel <span class="hljs-built_in">type</span>: dos<br>Disk identifier: 0xf9f150b0<br><br>Device     Boot  Start       End   Sectors  Size Id Type<br>rpimg.img1        8192    532479    524288  256M  c W95 FAT32 (LBA)<br>rpimg.img2      532480 125173759 124641280 59.4G 83 Linux<br><br></code></pre></td></tr></table></figure><p>fdisk 对 img 文件成功读取了分区信息，并且认为他是一个<strong>合法的设备</strong>。</p><h4 id="挂载-img-文件使其内部可以被操作">挂载 img 文件，使其内部可以被操作</h4><p>在<a href="https://man7.org/linux/man-pages/man4/loop.4.html">man pages</a>上写道</p><blockquote><p>The loop device is a block device that maps its data blocks not to a physical device such as a hard disk or optical disk drive, but to the blocks of a regular file in a filesystem or to another block device. This can be useful for example to provide a block device for a filesystem image stored in a file, so that it can be mounted with the mount(8) command.</p></blockquote><p>其上大概解释就是<code>loop device（回环设备）</code>是由<code>块设备</code>映射成的文件，</p><p><code>mount</code>命令的 man pages 有如下一段解释</p><blockquote><p>If no explicit loop device is mentioned (but just an option `-o loop' is given), then mount will try to find some unused loop device and use that, for example</p><p>mount /tmp/disk.img /mnt -o loop</p></blockquote><p>但是他挂载的 img 文件是单分区的，而我们的 img 文件含有多个分区</p><blockquote><p>This type of mount knows about three options, namely loop, offset and sizelimit, that are really options to losetup(8). (These options can be used in addition to those specific to the filesystem type.)</p></blockquote><p>所以如果我们镜像如果是多分区，我们可以使用 offset 和 sizelimit 参数来挂载。由于是最后一个分区所以我们就偷懒不写 sizelimit 了。</p><p>因此我们的命令就会如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-built_in">mkdir</span> mp <span class="hljs-comment"># 新建 img 文件挂载到的文件夹，把分区挂在这里</span><br>sudo mount ./rpimg.img ./mnt -o loop,offset=$((<span class="hljs-number">532480</span> * <span class="hljs-number">512</span>)) -t ext4<br></code></pre></td></tr></table></figure><blockquote><p>有可能遇到 loop 设备被占用的情况，这个时候我们需要使用 losetup -f 命令获取哪个 loop 设备可用。</p></blockquote><p>由于第一个分区是启动分区而且我们不操作他，所以我们不挂载他。</p><p>这里输入成功后是无回显的，证明他成功了</p><p>于是我们<code>ls mnt</code>看看</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">bin  boot  data  dev  etc  home  lib  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var<br></code></pre></td></tr></table></figure><p>是完整的根目录结构，意味着我们的目的成功了！</p><h3 id="使挂载-img-后的内容成为-chroot-jail">使挂载 img 后的内容成为 chroot jail</h3><p>在 <a href="https://wiki.debian.org/chroot">debian wiki</a> 上写了 chroot 的用法（英文）</p><p>同时 <a href="https://wiki.archlinux.org/title/Chroot_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">arch wiki</a> 上也有 chroot 用法的介绍</p><p>最关键的部分如下</p><ul><li>绑定 /sys 到 rootfs 的 sys 文件夹</li><li>绑定 /dev 到 rootfs 的 dev 文件夹</li><li>绑定 /proc 到 rootfs 的 proc 文件夹</li><li>复制本机的 DNS 服务器配置文件到 rootfs</li></ul><p>其中由于树莓派系统的 rootfs 自带了 DNS 配置文件，所以我们不需要再复制本机的 DNS 配置文件。</p><p>因此我们可以得出以下命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-built_in">cd</span> mnt                                  <span class="hljs-comment"># 切换到 img 文件的挂载文件夹</span><br>sudo mount --<span class="hljs-built_in">bind</span> /proc proc                 <span class="hljs-comment"># 挂载 proc</span><br>sudo mount --<span class="hljs-built_in">bind</span> /dev dev                   <span class="hljs-comment"># 挂载 dev</span><br>sudo mount --<span class="hljs-built_in">bind</span> /sys sys                   <span class="hljs-comment"># 挂载 sys</span><br><span class="hljs-comment">#cp -L /etc/resolv.conf etc/resolv.conf # 复制 DNS 配置文件，可选</span><br></code></pre></td></tr></table></figure><p>最后我们尝试使用 chroot 启动他。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">sudo <span class="hljs-built_in">chroot</span> . /bin/bash<br></code></pre></td></tr></table></figure><p>可以看到标识符发生了变化，那么意味着我们成功的挂载了 img 文件并且进入了其中。</p><h3 id="卸载-img-文件的挂载">卸载 img 文件的挂载</h3><p>当我们对 img 文件操作完毕后需要卸载 img 文件的挂载才算是完成了工作。</p><p>当然最简单的方法就是重启系统了，全自动卸载。我们这里使用手动卸载节约时间</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Bash">sudo losetup -d /dev/loop0  <span class="hljs-comment"># 卸载回环设备</span><br>sudo umount ./mnt/dev       <span class="hljs-comment"># 卸载 dev 绑定</span><br>sudo umount ./mnt/proc      <span class="hljs-comment"># 卸载 proc 绑定</span><br>sudo umount ./mnt/sys       <span class="hljs-comment"># 卸载 sys 绑定</span><br>sudo umount ./mnt           <span class="hljs-comment"># 卸载 img 文件挂载</span><br>sudo <span class="hljs-built_in">sync</span>                   <span class="hljs-comment"># 同步更改到磁盘</span><br></code></pre></td></tr></table></figure><p>OK，大功告成。</p></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/%E7%BC%96%E7%A8%8B/" class="category-chain-item">编程</a> <span>></span> <a href="/categories/%E7%BC%96%E7%A8%8B/%E5%B5%8C%E5%85%A5%E5%BC%8F/" class="category-chain-item">嵌入式</a> <span>></span> <a href="/categories/%E7%BC%96%E7%A8%8B/%E5%B5%8C%E5%85%A5%E5%BC%8F/%E6%A0%91%E8%8E%93%E6%B4%BE/" class="category-chain-item">树莓派</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/%E6%8A%80%E6%9C%AF/" class="print-no-link">#技术</a> <a href="/tags/%E6%8D%A3%E9%BC%93/" class="print-no-link">#捣鼓</a></div></div><div class="license-box my-3"><div class="license-title"><div>如何挂载.img文件，以及如何使用QEMU模拟arm64环境</div><div>https://blog.krysztal.dev/2021/08/04/如何挂载-img文件以及如何使用QEMU模拟arm64环境/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Krysztal</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2021年8月4日</div></div><div class="license-meta-item"><div>许可协议</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/2021/10/27/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%94%BB%E5%87%BB/" title="目录遍历攻击"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">目录遍历攻击</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2021/08/02/%E5%9C%A8%E6%A0%91%E8%8E%93%E6%B4%BE%E4%B8%8A%E7%BC%96%E8%AF%91OpenCV/" title="在树莓派上编译 OpenCV"><span class="hidden-mobile">在树莓派上编译 OpenCV</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><script type="text/javascript">Fluid.utils.loadComments("#comments",(function(){var t=document.documentElement.getAttribute("data-user-color-scheme");t="dark"===t?"github-dark":"github-light",window.UtterancesThemeLight="github-light",window.UtterancesThemeDark="github-dark";var e=document.createElement("script");e.setAttribute("src","https://utteranc.es/client.js"),e.setAttribute("repo","Krysztal112233/Krysztal112233.github.io"),e.setAttribute("issue-term","pathname"),e.setAttribute("label","utterances"),e.setAttribute("theme",t),e.setAttribute("crossorigin","anonymous"),document.getElementById("comments").appendChild(e)}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><script>Fluid.utils.createScript("https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js",(function(){mermaid.initialize({}),Fluid.utils.listenDOMLoaded((function(){Fluid.events.registerRefreshCallback((function(){"mermaid"in window&&mermaid.init()}))}))}))</script><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">总访问量 <span id="busuanzi_value_site_pv"></span> 次 </span><span id="busuanzi_container_site_uv" style="display:none">总访客数 <span id="busuanzi_value_site_uv"></span> 人</span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var i=jQuery("#board-ctn").offset().top;window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-i},CONFIG.toc)),t.find(".toc-list-item").length>0&&t.css("visibility","visible"),Fluid.events.registerRefreshCallback((function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback((function(){if("anchors"in window){anchors.removeAll();var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}}))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script>window.MathJax?(MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset(),MathJax.typesetPromise()):window.MathJax={tex:{inlineMath:{"[+]":[["$","$"]]}},loader:{load:["ui/lazy"]},options:{renderActions:{insertedScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(t=>{let e=t.parentNode;"li"===e.nodeName.toLowerCase()&&e.parentNode.classList.add("has-jax")})},"",!1]}}},Fluid.events.registerRefreshCallback((function(){"MathJax"in window&&MathJax.startup.document&&"function"==typeof MathJax.startup.document.state&&(MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset(),MathJax.typesetPromise())}))</script><script src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js"></script><script src="/js/local-search.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>